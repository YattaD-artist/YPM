<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Ao Sen H√† ƒê√¥ng - Ng√†y & ƒê√™m</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      transition: background 1s;
    }
    .sky {
      position: relative;
      width: 100%;
      height: 70vh;
      background: #87ceeb;
      overflow: hidden;
      transition: background 1s;
    }
    .pond {
      width: 100%;
      height: 30vh;
      background: #2d5000;
    }
    .lotus {
      position: absolute;
      bottom: 10%;
      left: 50%;
      width: 200px;
      transform: translateX(-50%);
    }
    .cloud, .raindrop, .star {
      position: absolute;
      border-radius: 50%;
      opacity: 0.8;
    }
    .cloud {
      background: white;
      width: 200px; height: 60px;
      top: 10%;
      left: -200px;
      animation: float 20s linear infinite;
    }
    .raindrop {
      width: 5px; height: 15px;
      background: lightblue;
      animation: fall 1s linear infinite;
    }
    .star {
      width: 2px;
      height: 2px;
      background: white;
      opacity: 0.6;
      animation: twinkle 2s infinite alternate;
    }
    .wind {
      animation: sway 3s infinite alternate;
    }
    @keyframes float {
      0% { left: -200px; }
      100% { left: 100%; }
    }
    @keyframes fall {
      0% { top: 0; opacity: 1; }
      100% { top: 100%; opacity: 0; }
    }
    @keyframes sway {
      from { transform: translateX(-5px); }
      to { transform: translateX(10px); }
    }
    @keyframes twinkle {
      0% { opacity: 0.3; }
      100% { opacity: 1; }
    }
    #info {
      padding: 12px;
      font-weight: bold;
      background: rgba(255,255,255,0.7);
    }
  </style>
</head>
<body>
  <div class="sky" id="sky">
    <img src="https://i.imgur.com/ypxYb6r.png" class="lotus" alt="Hoa sen">
  </div>
  <div class="pond"></div>
  <div id="info">ƒêang t·∫£i th·ªùi ti·∫øt H√† ƒê√¥ng...</div>

<script>
const API_KEY = '7787f162c8017c9c97a8a9ac9c271644';
const lat = 20.961, lon = 105.768;
const sky = document.getElementById('sky');
const lotus = document.querySelector('.lotus');
const info = document.getElementById('info');

async function getWeather() {
  try {
    const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=vi&appid=${API_KEY}`;
    const res = await fetch(url);
    const data = await res.json();

    const now = Date.now() / 1000; // th·ªùi gian hi·ªán t·∫°i (gi√¢y)
    const sunrise = data.sys.sunrise;
    const sunset = data.sys.sunset;
    const isNight = now < sunrise || now > sunset;

    const condition = data.weather[0].main.toLowerCase(); // 'clear', 'rain', 'clouds'
    const temp = data.main.temp;
    const wind = data.wind.speed;

    if (condition.includes('rain')) {
      setSkyRainy();
    } else if (condition.includes('cloud')) {
      setSkyCloudy();
    } else {
      setSkySunny();
    }

    if (isNight) {
      applyNightMode();
    }

    if (wind > 5) {
      lotus.classList.add('wind');
    }

    info.innerText = `Tr·∫°ng th√°i: ${data.weather[0].description} | Nhi·ªát ƒë·ªô: ${temp}¬∞C | Gi√≥: ${wind} m/s ${isNight ? '| Ban ƒë√™m üåô' : '| Ban ng√†y ‚òÄÔ∏è'}`;
  } catch (e) {
    info.innerText = "L·ªói khi t·∫£i th·ªùi ti·∫øt!";
    console.error(e);
  }
}

function applyNightMode() {
  sky.style.background = '#0b0c2a';
  removeWeatherElements();

  for (let i = 0; i < 100; i++) {
    const star = document.createElement('div');
    star.className = 'star';
    star.style.left = Math.random() * 100 + '%';
    star.style.top = Math.random() * 100 + '%';
    sky.appendChild(star);
  }
}

function setSkySunny() {
  sky.style.background = '#87ceeb';
  removeWeatherElements();
}

function setSkyCloudy() {
  sky.style.background = '#b0c4de';
  removeWeatherElements();
  for (let i = 0; i < 3; i++) {
    const cloud = document.createElement('div');
    cloud.className = 'cloud';
    cloud.style.top = `${10 + i * 10}%`;
    sky.appendChild(cloud);
  }
}

function setSkyRainy() {
  sky.style.background = '#708090';
  removeWeatherElements();
  for (let i = 0; i < 30; i++) {
    const drop = document.createElement('div');
    drop.className = 'raindrop';
    drop.style.left = `${Math.random() * 100}%`;
    drop.style.animationDelay = `${Math.random()}s`;
    sky.appendChild(drop);
  }
  setSkyCloudy();
}

function removeWeatherElements() {
  document.querySelectorAll('.cloud, .raindrop, .star').forEach(el => el.remove());
}

getWeather();
</script>
</body>
</html>
